import matplotlib.pyplot as plt
import numpy as np

# list of the value of the loss function

loss_values = [
    0.0004784780612681061,
    0.0003378646797500551,
    0.0003417234111111611,
    0.0004475133027881384,
    0.000498321489430964,
    0.0019068492110818624,
    0.0006032218807376921,
    0.0005033663474023342,
    0.0003660233924165368,
    0.000345443346304819,
    0.0003474936238490045,
    0.00033736752811819315,
    0.00033607357181608677,
    0.00041890423744916916,
    0.0003726212598849088,
    0.00037324902950786054,
    0.0004275189421605319,
    0.0003535976866260171,
    0.0003461891319602728,
    0.0007141102687455714,
    0.001745128189213574,
    0.0009911868255585432,
    0.0004961937083862722,
    0.0003790540504269302,
    0.0003667069540824741,
    0.00035494871553964913,
    0.0003627313126344234,
    0.0003997181192971766,
    0.0004193378263153136,
    0.00036642063059844077,
    0.00035836343886330724,
    0.0003477644349914044,
    0.0004491053696256131,
    0.00036071863723918796,
    0.0003544366336427629,
    0.0004494274326134473,
    0.00044568904559127986,
    0.0005715854931622744,
    0.0013536851620301604,
    0.0005086158635094762,
    0.00034089043037965894,
    0.000331180082866922,
    0.0003232583694625646,
    0.0003323960700072348,
    0.0003657800261862576,
    0.00038141486584208906,
    0.0003475361445453018,
    0.00034262731787748635,
    0.00038727439823560417,
    0.0003478348662611097,
    0.0003647476842161268,
    0.0004221145063638687,
    0.0003825374587904662,
    0.00035224680323153734,
    0.0003660188231151551,
    0.00043970849947072566,
    0.00034116616006940603,
    0.00039945277967490256,
    0.00041028682608157396,
    0.0006648351554758847,
    0.0011058120289817452,
    0.0007746834307909012,
    0.0005460657412186265,
    0.0005143882008269429,
    0.0004731003718916327,
    0.00042603479232639074,
    0.0004150886961724609,
    0.0004185575235169381,
    0.0005838493234477937,
    0.0004184565623290837,
    0.00039689525146968663,
    0.0003957776352763176,
    0.00042349426075816154,
    0.00039116485277190804,
    0.00039107512566260993,
    0.00043084222124889493,
    0.0004505477554630488,
    0.00044101261300966144,
    0.0004151807224843651,
    0.0004014178994111717,
    0.00044082931708544493,
    0.00041574263013899326,
    0.000409861357184127,
    0.000791854050476104,
    0.0004357803554739803,
    0.0003970097459387034,
    0.00039491229108534753,
    0.0003935914137400687,
    0.0003936489811167121,
    0.00040857188287191093,
    0.0005915036308579147,
    0.0008824982796795666,
    0.00042989812209270895,
    0.0003954971325583756,
    0.00038618629332631826,
    0.00039494410157203674,
    0.0004363045154605061,
    0.00041061671799980104,
    0.00040220239316113293,
    0.00042831359314732254,
    0.0004047841066494584,
    0.00046713175834156573,
    0.0008417671197094023,
    0.00049788155592978,
    0.0004027819668408483,
    0.00039616195135749876,
    0.000389239372452721,
    0.0003903447068296373,
    0.0003922289179172367,
    0.00039529785863123834,
    0.0003978018357884139,
    0.0005685476353392005,
    0.0004388633242342621,
    0.00041534280171617866,
    0.00040644576074555516,
    0.000471418141387403,
    0.00046771307825110853,
    0.0008015133207663894,
    0.0004486141260713339,
    0.0003980707551818341,
    0.0003927384677808732,
    0.0003921946045011282,
    0.00039203703636303544,
    0.00039404185372404754,
    0.0003995924780610949,
    0.0006909136427566409,
    0.0004726029874291271,
    0.00040231324965134263
]

# x = np.arange(len(loss_values))
x = np.linspace(0, len(loss_values)*5, len(loss_values))
# plot the loss function
plt.plot(x,loss_values)
plt.title('Loss iteration on blocks')
plt.xlabel('Epoch')
plt.ylabel('Loss')

# Ajouter des lignes verticales tous les x multiples de 80
for i in range(0, int(max(x)), 80):
    if i == 0:
        plt.axvline(x=i, color='r', linestyle='--', linewidth=1, label='Début d\'entraînement sur un nouveau bloc')
    else:
        plt.axvline(x=i, color='r', linestyle='--', linewidth=1)
plt.legend()
plt.show()

